<nav class="w-full   bg-gray-800  px-4 py-4 md:py-2 md:flex grid grid-cols-1 items-center justify-between gap-4 md:gap-0 ">
    <a href="/" class="flex items-center space-x-4 m-auto md:m-0">
        <img src="/LOGO.png" alt="ir para home" class=" h-14 w-14">
        <h2 class="text-2xl text-white font-semibold">PLAYTORRENT</h2>
    </a>

    <div class= " md:flex items-center space-x-4 justify-center md:justify-between ">

        <div class=" bg-white overflow-hidden rounded-md flex items-center justify-center px-2 h-10 w-full md:w-96  py-0">
            <input id="inputPesquisa" type="text" placeholder="Pesquisar" class="px-4  w-full  focus:outline-none text-gray-600">
           
            <span class="material-symbols-outlined text-gray-600  px-2 text-2xl duration-300 hover:scale-125">
                <img onclick="search()" src="/icons/icons8-lupa-100.png" class="w-8 " alt="">
            </span>
      
        </div>
        
        <ul class=" md:p-4 w-full md:w-auto space-x-4 text-white  flex items-center justify-around pt-4 md:pt-auto " style="margin: 0;">
            <!-- PLATAFORMA -->
            <li>
                <% const platformArry = ['COMPUTADOR', 'PS2', 'PS3', 'PSP', 'XBOX 360'] %>
                <%- include('./dropdown.ejs',  {title: 'PLATAFORMA', array: platformArry, pg: '1'}) %>
            </li>

            <!-- GENERO -->
            <li>
                <% const generoArry = ['ANIME', 'AVENTURA', 'CASUAL', 'CORRIDA', 'CRIME', 'DESTRUIÇÃO', 'DESTRUIÇÃO', 'ESPORTES', 'ESTRATÉGIA', 'FANTASIA', 'FICÇÃO', 'HISTÓRIA', 'INDIE', 'LUTA', 'MUNDO_ABERTO', 'NUDEZ', 'PLATAFORMA', 'PUZZLE', 'RPG', 'SIMULAÇÃO', 'SOBREVIVÊNCIA', 'TERROR', 'TIRO', 'TOP_GAMES', 'NSW'] %>
                <%- include('./dropdown.ejs',  {title: 'GENERO', array: generoArry, pg: '1'}) %>
            </li>


            <!-- Home -->
            <li>
                <a href="/">
                    <span class="material-symbols-outlined text-gray-white text-2xl duration-300 hover:scale-125">
                        <img src="/icons/icons8-casa-100.png" class="w-7" alt="home">
                    </span>
                </a>
            </li>

            <!-- USUARIO -->
            <li>
                <% const generoAuth = ['login', 'register'] %>
                <%- include('./dropdown.ejs',  {title: 'AUTH', img:'/icons/icons8-usuário-96.png', array: generoAuth}) %>
            </li>

            <li>
                <h2 id="Username" class="text-white"></h2>
                <script>
                    const userName = localStorage.userName
                    if(userName && userName !== 'undefined'){
                        document.getElementById('Username').innerText = userName
                    }
                </script>
            </li>


    
        </ul>


    </div>

    
    
   
</nav>



<script>
const inputPesquisa = document.getElementById('inputPesquisa');

function search() {
    const valorDoInput = inputPesquisa.value;

    // Verifica se o valor do input não está vazio
    if (valorDoInput.trim() !== "") {
        // Redireciona para a página desejada
        window.location.href = "/search/" + encodeURIComponent(valorDoInput);
    } else {
        // Lida com o caso em que o valor do input está vazio
        alert("Por favor, insira um termo de pesquisa válido.");
    }
}


inputPesquisa.addEventListener('keyup', (event) => {
    if(event.keyCode == 13){
        search();
    }
});


</script>




<script>
    function checkUserLoggedIn() {
        function getCookie(name) {
            const cookies = document.cookie.split('; ');
            for (const cookie of cookies) {
                const [cookieName, cookieValue] = cookie.split('=');
                if (cookieName === name) {
                    return cookieValue;
                }
            }
            return null;
        }
        const token = getCookie('tokenUser');

        if (token) {
            console.log('Usuário está com token.');

            fetch('/auth/check-token', {
                method: "POST",
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({token: token})
            })
            .then(res => res.json())
            .then((response)=>{
                console.log(response)
                localStorage.userName = response.userName
            })
        } else {
            // Token não existe, usuário não está logado
            console.log('Usuário não está logado.');
        }
    }checkUserLoggedIn();

</script>